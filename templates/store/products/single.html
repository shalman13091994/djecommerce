{% extends "../base.html" %}
{% block title %} my product {% endblock %}
{% block content %}

<div class="container">
    <main class="pt-5">
        <div class="row g-5">
            <div class="col-md-5 col-lg-5 order-md-first bg-light">
                <img class="img-fluid mx-auto d-block" width="200px" alt="Responsive image"
                    src="{{ product.image.url }}">

            </div>
            <div class="col-md-7 col-lg-7 ps-md-3 ps-lg-5">
                <h1 class="mb-0 h4">{{ product.title }}</h1>
                <p><span class="lead ">{{ product.author }}</span> (Author) </p>
                <p>{{ product.description |slice:":355" }}....</p>
                <div class="border">
                    <div class="col border-bottom">
                        <div class="row p-3">
                            <div class="col-6">Hardback</div>
                            <div class="col-6 text-end"><span class="h4 fw-bold">Rs {{ product.price }}</span></div>
                        </div>
                    </div>
                    <div class="col">
                        <div class="row p-3">
                            <div class="col-6">
                                <label for="select">Quantity</label>
                                <select id="select">
                                    <option value="">1</option>
                                    <option value="">2</option>
                                    <option value="">3</option>
                                    <option value="">4</option>
                                </select>
                            </div>
                            <div class="col-6 text-end">
                                <button type="button" id="add-button" value="{{product.id}}"
                                    class="btn btn-secondary">Add to cart</button>
                            </div>
                        </div>

                    </div>
                </div>
            </div>
        </div>
    </main>
</div>

<!-- java script-->
<!-- on click find the id i.e,., add button function is we prevent the default is 1 
now again ajax will be there to add backend to front end 
there we mentioning the post type and url and data with productid i.e., id="add-button" and .value
csrfmiddlewaretoken to prevent from hijacking and action is post
we get all these from the button once we click on the add to cart button these things to happen that can 
be mentioned in javascript-->

<script>
    $(document).on('click', '#add-button', function (e) {
        e.preventDefault();

        $.ajax({
            type: 'POST',
            url: '{% url "basket:basket_add" %}',
            data: {
                productid: $('#add-button').val(),
                productqty: $('#select option:selected').text(),
                csrfmiddlewaretoken: "{{csrf_token}}",
                action: 'post'
            },
            success: function (json) {
                document.getElementById("basket-qty").innerHTML = json.qty


            },

            error: function (xhr, errmsg, err) {}
        });
    })
</script>

{% endblock %}